<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAMS Quiz Setup Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #ccc;
        }
        .test-item.pass {
            background: #d4edda;
            border-left-color: #28a745;
        }
        .test-item.fail {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        .test-item.warning {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        .status {
            font-weight: bold;
        }
        .pass .status { color: #28a745; }
        .fail .status { color: #dc3545; }
        .warning .status { color: #ffc107; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>CAMS Quiz Setup Test</h1>
        <p>This page tests if all components are properly set up for the CAMS Quiz Launcher.</p>
        
        <div id="test-results"></div>
        
        <div style="margin-top: 20px;">
            <button onclick="runTests()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Run Tests</button>
            <button onclick="window.location.href='index.html'" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-left: 10px;">Go to Launcher</button>
        </div>
    </div>

    <script>
        function runTests() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<h3>Running Tests...</h3>';
            
            const tests = [
                {
                    name: 'Main Launcher',
                    test: () => fetch('index.html').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Manifest File',
                    test: () => fetch('manifest.json').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Service Worker',
                    test: () => fetch('sw.js').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Final Exam Simulator (Super)',
                    test: () => fetch('Assessment Tests/cams_final_exam_sim_SUPER.html').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Final Exam Simulator',
                    test: () => fetch('Assessment Tests/cams_final_exam_sim.html').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Topic Drills',
                    test: () => fetch('Assessment Tests/cams_quiz.html').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Full Trainer Pack',
                    test: () => fetch('Assessment Tests/cams_trainer_full.html').then(r => r.ok),
                    required: true
                },
                {
                    name: 'Legacy Test Questions',
                    test: () => fetch('Test Questions 1/index.html').then(r => r.ok),
                    required: false
                },
                {
                    name: 'Legacy Data File',
                    test: () => fetch('Test Questions 1/js/data.js').then(r => r.ok),
                    required: false
                },
                {
                    name: 'Legacy Script File',
                    test: () => fetch('Test Questions 1/js/index.js').then(r => r.ok),
                    required: false
                },
                {
                    name: 'App Icon (192x192)',
                    test: () => fetch('icons/icon-192x192.png').then(r => r.ok),
                    required: true
                },
                {
                    name: 'App Icon (512x512)',
                    test: () => fetch('icons/icon-512x512.png').then(r => r.ok),
                    required: true
                }
            ];
            
            let passed = 0;
            let failed = 0;
            let warnings = 0;
            
            Promise.all(tests.map(test => 
                test.test()
                    .then(success => ({ ...test, success }))
                    .catch(() => ({ ...test, success: false }))
            )).then(results => {
                const html = results.map(result => {
                    let className = 'test-item ';
                    let status = '';
                    
                    if (result.success) {
                        className += 'pass';
                        status = 'PASS';
                        passed++;
                    } else if (result.required) {
                        className += 'fail';
                        status = 'FAIL';
                        failed++;
                    } else {
                        className += 'warning';
                        status = 'WARNING';
                        warnings++;
                    }
                    
                    return `
                        <div class="${className}">
                            <span class="status">${status}</span> - ${result.name}
                        </div>
                    `;
                }).join('');
                
                const summary = `
                    <h3>Test Results</h3>
                    <div class="test-item pass">
                        <span class="status">PASSED: ${passed}</span>
                    </div>
                    <div class="test-item fail">
                        <span class="status">FAILED: ${failed}</span>
                    </div>
                    <div class="test-item warning">
                        <span class="status">WARNINGS: ${warnings}</span>
                    </div>
                    <hr>
                    ${html}
                `;
                
                document.getElementById('test-results').innerHTML = summary;
                
                if (failed === 0) {
                    document.getElementById('test-results').innerHTML += `
                        <div class="test-item pass">
                            <span class="status">SETUP COMPLETE!</span> - All required components are working correctly.
                        </div>
                    `;
                } else {
                    document.getElementById('test-results').innerHTML += `
                        <div class="test-item fail">
                            <span class="status">SETUP INCOMPLETE!</span> - Please fix the failed tests before deploying.
                        </div>
                    `;
                }
            });
        }
        
        // Auto-run tests on page load
        window.addEventListener('load', runTests);
    </script>
</body>
</html>
